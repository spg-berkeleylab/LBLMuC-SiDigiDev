<?xml version="1.0" encoding="us-ascii"?>
<marlin xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://ilcsoft.desy.de/marlin/marlin.xsd">

  <constants>
  </constants>
  
  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->
  <!-- == List of processors to execute                                                                      == -->
  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->

  <execute>

    <!-- ==========  Setup  ========== -->
    <processor name="MyAIDAProcessor"/>
    <processor name="EventNumber" />
    <processor name="Config" />

    <!-- ==========  Geometry initialization  ========== -->
    <processor name="InitDD4hep_mod4"/>

    <!-- ==========  Tracker Digitization  ========== -->
    <!-- <processor name="VXDBarrelDigitiser"/> -->
    <processor name="VXDBarrelRealisticDigiCMS"/> 
    <!-- disable other digi jobs for now
    <processor name="VXDEndcapDigitiser"/>
    <processor name="InnerPlanarDigiProcessor"/>
    <processor name="InnerEndcapPlanarDigiProcessor"/>
    <processor name="OuterPlanarDigiProcessor"/>
    <processor name="OuterEndcapPlanarDigiProcessor"/>
    -->

    <!-- ==========  Tracking  ========== -->
    <!-- At the moment the name of the final track collection for the MyTruthTrackFinder and MyExtrToTracker processors is the same, 
         so that users can use this example to run easily both the cheater track pattern recognition (still the default for many tasks) 
         or the real one (under final tests) -->
    <!-- disable tracking 
    <if condition="Config.TrackingTruth">
      <processor name="MyTruthTrackFinder"/>
    </if>
    <if condition="Config.TrackingConformal">
      <processor name="ConformalTrackingILC"/>
      <processor name="ClonesAndSplitTracksFinder"/>
    </if>
    <processor name="Refit" />
    -->

    <!-- ==========  Monitoring  ========== -->
    <!-- disable monitoring 
    <processor name="MyClicEfficiencyCalculator"/>
    <processor name="MyRecoMCTruthLinker"/>
    <processor name="MyTrackChecker"/>
    -->
    <!-- <processor name="MyHitResiduals"/> --> <!-- please uncomment the use of this processor only if needed -->

    <!-- ==========  LCTuple  ========== -->
    <processor name="MyLCTuple" />

    <!-- ==========  Output  ========== -->
    <processor name="Output_REC"/>
    <!-- <processor name="Output_DST"/> -->

  </execute>


  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->
  <!-- == Global setup                                                                                       == -->
  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->

  <processor name="Config" type="CLICRecoConfig" >
    <parameter name="Verbosity" options="DEBUG0-9,MESSAGE0-9,WARNING0-9,ERROR0-9,SILENT"> MESSAGE  </parameter>
    <!--Which option to use for Overlay: False, BIB. Then use, e.g., Config.OverlayFalse in the condition-->
    <parameter name="Overlay" type="string">False</parameter>
    <!--Possible values and conditions for option Overlay-->
    <parameter name="OverlayChoices" type="StringVec">False BIB</parameter>
    <!--Which option to use for Tracking: Truth, ConformalPlusExtrapolator, Conformal. Then use, e.g., Config.TrackingTruth in the condition-->
    <parameter name="Tracking" type="string">Conformal </parameter>
    <!--Possible values and conditions for option Tracking-->
    <parameter name="TrackingChoices" type="StringVec">Truth Conformal  </parameter>
    <!--Which option to use for VertexUnconstrained: ON, OFF. Then use, e.g., Config.VertexUnconstrainedOFF in the condition-->
    <parameter name="VertexUnconstrained" type="string">OFF </parameter>
    <!--Possible values and conditions for option Tracking-->
    <parameter name="VertexUnconstrainedChoices" type="StringVec">ON OFF  </parameter>
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <parameter name="Verbosity" options="DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT"> MESSAGE  </parameter> 
  </processor>

  <processor name="EventNumber" type="Statusmonitor">
    <parameter name="HowOften" type="int">1 </parameter>
    <parameter name="Verbosity" type="string"> MESSAGE </parameter>
  </processor>

  <processor name="MyAIDAProcessor" type="AIDAProcessor">
    <!--Processor that handles AIDA files. Creates on directory per processor.  Processors only need to create and fill the histograms, clouds and tuples. Needs to be the first ActiveProcessor-->
    <!-- compression of output file 0: false >0: true (default) -->
    <parameter name="Compress" type="int" value="1"/>
    <!-- filename without extension-->
    <parameter name="FileName" type="string"> ntuple_tracker </parameter>
    <!-- type of output file xml (default) or root ( only OpenScientist)-->
    <parameter name="FileType" type="string" value="root "/>
  </processor>


  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->
  <!-- == Input configuration                                                                               == -->
  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->

  <global>
    <parameter name="LCIOInputFiles">
      muonGun_sim_MuColl_v1.slcio
    </parameter>
    <!-- Limit the number of processed records (run+evt): -->
    <parameter name="MaxRecordNumber" value="-1" />
    <parameter name="SkipNEvents" value="0" />
    <parameter name="SupressCheck" value="false" />  
    <parameter name="Verbosity" options="DEBUG0-9,MESSAGE0-9,WARNING0-9,ERROR0-9,SILENT">WARNING </parameter>
    <parameter name="RandomSeed" value="1234567890" />
  </global>


  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->
  <!-- == Output configuration                                                                               == -->
  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->

  <processor name="Output_REC" type="LCIOOutputProcessor">
    <!--   standard output: full reconstruction keep all collections -->
    <parameter name="LCIOOutputFile" type="string"> Output_REC.slcio </parameter>
    <parameter name="FullSubsetCollections" type="StringVec"> EfficientMCParticles InefficientMCParticles </parameter>
    <parameter name="LCIOWriteMode" type="string" value="WRITE_NEW"/>
    <!-- <parameter name="SplitFileSizekB" type="int">996147 </parameter> -->
    <parameter name="Verbosity" type="string">WARNING </parameter>
    <parameter name="DropCollectionNames" type="StringVec">  </parameter>
    <parameter name="DropCollectionTypes" type="StringVec">  </parameter>
    <parameter name="KeepCollectionNames" type="StringVec">  </parameter>
  </processor>

  <processor name="Output_DST" type="LCIOOutputProcessor">
    <!--   dst output: keep only collections for analysis -->
    <parameter name="LCIOOutputFile" type="string"> Output_DST.slcio </parameter>
    <parameter name="FullSubsetCollections" type="StringVec">
    </parameter>
    <parameter name="DropCollectionTypes" type="StringVec">
      LCRelation
      TrackerHitPlane
      ReconstructedParticle 
      SimTrackerHit
      TrackerHit
      Track
      Cluster
    </parameter>
    <parameter name="KeepCollectionNames" type="StringVec">
      RecoMCTruthLink
      SiTracksMCTruthLink
      MergedRecoParticles
      MCParticle
      MCPhysicsParticles
      VXDTrackerHitRelations 
      VXDEndcapTrackerHitRelations 
      InnerTrackerBarrelHitsRelations 
      OuterTrackerBarrelHitsRelations 
      InnerTrackerEndcapHitsRelations 
      OuterTrackerEndcapHitsRelations
      VXDTrackerHits 
      VXDEndcapTrackerHits 
      ITrackerHits 
      OTrackerHits 
      ITrackerEndcapHits 
      OTrackerEndcapHits
      SiTracks
      SiTracksCT
      SiTracks_Refitted
    </parameter>
    <parameter name="DropCollectionNames" type="StringVec">  </parameter>
    <parameter name="LCIOWriteMode" type="string" value="WRITE_NEW"/>
    <!-- <parameter name="SplitFileSizekB" type="int">996147 </parameter> -->
    <parameter name="Verbosity" type="string">WARNING </parameter>
  </processor>

  
  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->
  <!-- == DD4hep configuration                                                                               == -->
  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->
  
  <processor name="InitDD4hep_mod4" type="InitializeDD4hep">
    <!--InitializeDD4hep reads a compact xml file and initializes the dd4hep::Detector object-->
    <!--Name of the DD4hep compact xml file to load-->
    <parameter name="DD4hepXMLFile" type="string">
      /opt/ilcsoft/muonc/detector-simulation/geometries/MuColl_v1/MuColl_v1.xml
    </parameter>
    <!--Alternate name for EncodingStringParameterName-->
    <!--If given, the Compact File parameter of that name will be used as argument to LCTrackerCellID::set_encoding_string()-->
    <parameter name="EncodingStringParameterName" type="string"> GlobalTrackerReadoutID  </parameter>
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <!--parameter name="Verbosity" type="string">DEBUG </parameter-->
  </processor>


  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->
  <!-- == LCTuple configuration                                                                              == -->
  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->
  <processor name="MyLCTuple" type="LCTuple">
    <!--LCTuple creates a ROOT TTRee with a column wise ntuple from LCIO collections ....-->
    <parameter name="FullSubsetCollections" type="StringVec"> EfficientMCParticles InefficientMCParticles </parameter>
    <!--Name of the CalorimeterHit collection-->
    <parameter name="CalorimeterHitCollection" type="string" lcioInType="CalorimeterHit"> </parameter>
    <!--Name of the Cluster collection-->
    <parameter name="ClusterCollection" type="string" lcioInType="Cluster"> </parameter>
    <!--Name of the IsoLep collection-->
    <parameter name="IsoLepCollection" type="string" lcioInType="ReconstructedParticle"> </parameter>
    <!--Name of the Jet collection-->
    <parameter name="JetCollection" type="string" lcioInType="ReconstructedParticle"> JetOut </parameter>
    <!--Switch to write out extra parameters calculated using information from Jet Finder-->
    <parameter name="JetCollectionExtraParameters" type="bool">true </parameter>
    <!--Switch to write out jet parameters coming from LCFIPlus tagging processor-->
    <parameter name="JetCollectionTaggingParameters" type="bool">false </parameter>
    <!--Names of LCRelation collections - need parallel prefix names in RelPrefixes-->
    <parameter name="LCRelationCollections" type="StringVec" lcioInType="LCRelation">
      RecoMCTruthLink 
      SiTracksMCTruthLink
    </parameter>
    <!-- Names of prefixes for variables from LCRelation collections - needs to be parallel to LCRelationCollections (one prefix per collection)-->
    <parameter name="LCRelationPrefixes" type="StringVec">  
      r2m  
      r2t  
    </parameter>
    <!--Names of LCRelation collections of PFO-->
    <parameter name="LCRelationwithPFOCollections" type="string" lcioInType="LCRelation"> </parameter>
    <!--Name of the MCParticle collection-->
    <parameter name="MCParticleCollection" type="string" lcioInType="MCParticle"> </parameter>
    <parameter name="MCParticleNotReco" type="string" lcioOutType="MCParticle"> </parameter>
    <!--Name of the MCParticle collection where the overlay is removed-->
    <!--parameter name="MCParticleRemoveOverlayCollection" type="string" lcioInType="MCParticle"> </parameter-->
    <!--Name of the PFO collection with Relation-->
    <!--parameter name="PFOwithRelationCollection" type="string" lcioInType="ReconstructedParticle"> </parameter-->
    <!--Name of the ReconstructedParticle collection-->
    <parameter name="RecoParticleCollection" type="string" lcioInType="ReconstructedParticle"> </parameter> 
    <!--Name of the SimCalorimeterHit collection-->
    <parameter name="SimCalorimeterHitCollection" type="string" lcioInType="SimCalorimeterHit"> </parameter>
    <!--Name of the SimTrackerHit collection-->
    <parameter name="SimTrackerHitCollection" type="string" lcioInType="SimTrackerHit"> VertexBarrelCollection </parameter>
    <!--Name of the Track collection-->
    <parameter name="TrackCollection" type="string" lcioInType="Track">SiTracks_Refitted </parameter>
    <!--Name of the TrackerHit collection-->
    <parameter name="TrackerHitCollection" type="string" lcioInType="TrackerHit"> VXDTrackerHits </parameter>    
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <!--parameter name="Verbosity" type="string">DEBUG </parameter-->
    <!--Name of the Vertex collection-->
    <parameter name="VertexCollection" type="string" lcioInType="Vertex"> PrimaryVertices </parameter>
    <!--Switch to write out collection parameters-->
    <parameter name="WriteCalorimeterHitCollectionParameters" type="bool">false </parameter>
    <!--Switch to write out collection parameters-->
    <parameter name="WriteClusterCollectionParameters" type="bool">false </parameter>
    <!--Switch to write out collection parameters-->
    <parameter name="WriteIsoLepCollectionParameters" type="bool">false </parameter>
    <!--Switch to write out collection parameters-->
    <parameter name="WriteJetCollectionParameters" type="bool">false </parameter>
    <!--Switch to write out collection parameters-->
    <parameter name="WriteMCParticleCollectionParameters" type="bool">true </parameter>
    <!--Switch to write out collection parameters-->
    <parameter name="WriteRecoParticleCollectionParameters" type="bool">true </parameter>
    <!--Switch to write out collection parameters-->
    <parameter name="WriteSimCalorimeterHitCollectionParameters" type="bool">false </parameter>
    <!--Switch to write out collection parameters-->
    <parameter name="WriteSimTrackerHitCollectionParameters" type="bool">true </parameter>
    <!--Switch to write out collection parameters-->
    <parameter name="WriteTrackCollectionParameters" type="bool">true </parameter>
    <!--Switch to write out collection parameters-->
    <parameter name="WriteTrackerHitCollectionParameters" type="bool">true </parameter>
    <!--Switch to write out collection parameters-->
    <parameter name="WriteVertexCollectionParameters" type="bool">true </parameter>
  </processor>
  
  
  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->
  <!-- == Tracker Digitizer configuration                                                                    == -->
  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->

  <processor name="VXDBarrelRealisticDigiCMS" type="MuonCVXDDigitiser">
    <parameter name="CollectionName" type="string"> VertexBarrelCollection </parameter>
    <parameter name="OutputCollectionName" type="string"> VXDTrackerHits </parameter>
    <parameter name="RelationColName" type="string"> VTXTrackerHitRelations </parameter>
    <parameter name="SubDetectorName" type="string"> VertexBarrel </parameter>
    <!--Tangent of Lorentz angle (and optional Y component)-->
    <parameter name="TanLorentz" type="float"> 0.8 </parameter>
    <parameter name="TanLorentzY" type="float"> 0.0 </parameter>
    <!--Min threshold for delta-rays (MeV)-->
    <parameter name="CutOnDeltaRays" type="float"> 0.030 </parameter>
    <!-- Diffusion coefficient (in mm) for layer thickness-->
    <parameter name="Diffusion" type="float"> 0.2 </parameter>
    <!-- Pixel size (mm) -->
    <parameter name="PixelSizeX" type="float"> 0.025 </parameter>
    <parameter name="PixelSizeY" type="float"> 0.025 </parameter>
    <!-- Number of electron-hole pairs per keV -->
    <parameter name="ElectronsPerKeV" type="float"> 270.3 </parameter>
    <!-- FE threshold (in electrons) -->
    <parameter name="Threshold" type="float"> 200 </parameter>
    <!-- Segment Length in mm -->
    <parameter name="SegmentLength" type="float"> 0.005 </parameter>
    <!-- Width of cluster -->
    <parameter name="WidthOfCluster" type="float"> 3.0 </parameter>
    <!-- Apply Poisson smearing of electrons collected on pixels -->
    <parameter name="PoissonSmearing" type="int"> 1 </parameter>
    <!-- Apply Electronic Effects and set noise -->
    <parameter name="ElectronicEffects" type="int"> 1 </parameter>
    <parameter name="ElectronicNoise" type="float"> 100 </parameter>
    <!-- store all fired pixels -->
    <parameter name="StoreFiredPixels" type="int"> 1 </parameter>
    <!-- Energy Loss keV/mm -->
    <parameter name="EnergyLoss" type="float"> 280.0 </parameter>
    <!-- Max delta in energy for hit in electrons -->
    <parameter name="MaxEnergyDelta" type="float"> 100.0 </parameter> 
    <!-- Maximum values for track length (in mm) -->
    <parameter name="MaxTrackLength" type="float"> 10.0 </parameter>
  </processor>


  <processor name="VXDBarrelDigitiser" type="DDPlanarDigiProcessor">
    <parameter name="SubDetectorName" type="string"> Vertex </parameter>
    <!--PlanarDigiProcessor creates TrackerHits from SimTrackerHits, smearing them according to the input parameters.-->
    <!--whether hits are 1D strip hits-->
    <parameter name="IsStrip" type="bool">false </parameter>
    <!--resolution in direction of u-->
    <parameter name="ResolutionU" type="float"> 0.005 </parameter>
    <!--resolution in direction of v-->
    <parameter name="ResolutionV" type="float"> 0.005 </parameter>
    <!--Name of the Input SimTrackerHit collection-->
    <parameter name="SimTrackHitCollectionName" type="string" lcioInType="SimTrackerHit"> VertexBarrelCollection </parameter>
    <!--Name of TrackerHit SimTrackHit relation collection-->
    <parameter name="SimTrkHitRelCollection" type="string" lcioOutType="LCRelation"> VXDTrackerHitRelations </parameter>
    <!--Name of the TrackerHit output collection-->
    <parameter name="TrackerHitCollectionName" type="string" lcioOutType="TrackerHitPlane"> VXDTrackerHits </parameter>
    <!--resolution in time-->
    <parameter name="ResolutionT" type="FloatVec"> 0.05  </parameter>
    <!--resolution in direction of u - either one per layer or one for all layers -->
    <parameter name="UseTimeWindow" type="bool"> true </parameter>
    <!--Correct hit times for propagation: radial distance/c-->
    <parameter name="CorrectTimesForPropagation" type="bool" value="true"/>
    <!--Lower bound of the time window [ns]-->
    <parameter name="TimeWindowMin" type="float"> -0.15 </parameter>
    <!--Upper bound of the time window [ns]-->
    <parameter name="TimeWindowMax" type="float"> 0.15 </parameter>
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <parameter name="Verbosity" type="string"> WARNING </parameter>
  </processor>

  <processor name="VXDEndcapDigitiser" type="DDPlanarDigiProcessor">
    <parameter name="SubDetectorName" type="string"> Vertex </parameter>
    <!--PlanarDigiProcessor creates TrackerHits from SimTrackerHits, smearing them according to the input parameters.-->
    <!--whether hits are 1D strip hits-->
    <parameter name="IsStrip" type="bool">false </parameter>
    <!--resolution in direction of u-->
    <parameter name="ResolutionU" type="float"> 0.005 </parameter>
    <!--resolution in direction of v-->
    <parameter name="ResolutionV" type="float"> 0.005 </parameter>
    <!--Name of the Input SimTrackerHit collection-->
    <parameter name="SimTrackHitCollectionName" type="string" lcioInType="SimTrackerHit"> VertexEndcapCollection </parameter>
    <!--Name of TrackerHit SimTrackHit relation collection-->
    <parameter name="SimTrkHitRelCollection" type="string" lcioOutType="LCRelation"> VXDEndcapTrackerHitRelations </parameter>
    <!--Name of the TrackerHit output collection-->
    <parameter name="TrackerHitCollectionName" type="string" lcioOutType="TrackerHitPlane"> VXDEndcapTrackerHits </parameter>
    <!--resolution in time-->
    <parameter name="ResolutionT" type="FloatVec"> 0.05  </parameter>
    <!--resolution in direction of u - either one per layer or one for all layers -->
    <parameter name="UseTimeWindow" type="bool"> true </parameter>
    <!--Correct hit times for propagation: radial distance/c-->
    <parameter name="CorrectTimesForPropagation" type="bool" value="true"/>
    <!--Lower bound of the time window [ns]-->
    <parameter name="TimeWindowMin" type="float"> -0.15 </parameter>
    <!--Upper bound of the time window [ns]-->
    <parameter name="TimeWindowMax" type="float"> 0.15 </parameter>
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <parameter name="Verbosity" type="string"> WARNING </parameter>
  </processor>

  <processor name="InnerPlanarDigiProcessor" type="DDPlanarDigiProcessor">
    <!--PlanarDigiProcessor creates TrackerHits from SimTrackerHits, smearing them according to the input parameters.-->
    <parameter name="SubDetectorName" type="string"> InnerTrackers </parameter>
    <!--whether hits are 1D strip hits-->
    <parameter name="IsStrip" type="bool"> false </parameter>
    <!--resolution in direction of u-->
    <parameter name="ResolutionU" type="float"> 0.010 </parameter>
    <!--resolution in direction of v-->
    <parameter name="ResolutionV" type="float"> 0.010 </parameter>
    <!--Name of the Input SimTrackerHit collection-->
    <parameter name="SimTrackHitCollectionName" type="string" lcioInType="SimTrackerHit"> InnerTrackerBarrelCollection </parameter>
    <!--Name of TrackerHit SimTrackHit relation collection-->
    <parameter name="SimTrkHitRelCollection" type="string" lcioOutType="LCRelation"> InnerTrackerBarrelHitsRelations </parameter>
    <!--Name of the TrackerHit output collection-->
    <parameter name="TrackerHitCollectionName" type="string" lcioOutType="TrackerHitPlane"> ITrackerHits </parameter>
    <!--resolution in time-->
    <parameter name="ResolutionT" type="FloatVec"> 0.1  </parameter>
    <!--resolution in direction of u - either one per layer or one for all layers -->
    <parameter name="UseTimeWindow" type="bool"> true </parameter>
    <!--Correct hit times for propagation: radial distance/c-->
    <parameter name="CorrectTimesForPropagation" type="bool" value="true"/>
    <!--Lower bound of the time window [ns]-->
    <parameter name="TimeWindowMin" type="float"> -0.3 </parameter>
    <!--Upper bound of the time window [ns]-->
    <parameter name="TimeWindowMax" type="float"> 0.3 </parameter>
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <parameter name="Verbosity" type="string"> WARNING </parameter>
  </processor>

  <processor name="InnerEndcapPlanarDigiProcessor" type="DDPlanarDigiProcessor">
    <!--PlanarDigiProcessor creates TrackerHits from SimTrackerHits, smearing them according to the input parameters.-->
    <parameter name="SubDetectorName" type="string"> InnerTrackers </parameter>
    <!--whether hits are 1D strip hits-->
    <parameter name="IsStrip" type="bool"> false </parameter>
    <!--resolution in direction of u-->
    <parameter name="ResolutionU" type="float"> 0.010 </parameter>
    <!--resolution in direction of v-->
    <parameter name="ResolutionV" type="float"> 0.010 </parameter>
    <!--Name of the Input SimTrackerHit collection-->
    <parameter name="SimTrackHitCollectionName" type="string" lcioInType="SimTrackerHit"> InnerTrackerEndcapCollection </parameter>
    <!--Name of TrackerHit SimTrackHit relation collection-->
    <parameter name="SimTrkHitRelCollection" type="string" lcioOutType="LCRelation"> InnerTrackerEndcapHitsRelations </parameter>
    <!--Name of the TrackerHit output collection-->
    <parameter name="TrackerHitCollectionName" type="string" lcioOutType="TrackerHitPlane"> ITrackerEndcapHits </parameter>
    <!--resolution in time-->
    <parameter name="ResolutionT" type="FloatVec"> 0.1  </parameter>
    <!--resolution in direction of u - either one per layer or one for all layers -->
    <parameter name="UseTimeWindow" type="bool"> true </parameter>
    <!--Correct hit times for propagation: radial distance/c-->
    <parameter name="CorrectTimesForPropagation" type="bool" value="true"/>
    <!--Lower bound of the time window [ns]-->
    <parameter name="TimeWindowMin" type="float"> -0.3 </parameter>
    <!--Upper bound of the time window [ns]-->
    <parameter name="TimeWindowMax" type="float"> 0.3 </parameter>
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <parameter name="Verbosity" type="string"> WARNING </parameter>
  </processor>

  <processor name="OuterPlanarDigiProcessor" type="DDPlanarDigiProcessor">
    <!--PlanarDigiProcessor creates TrackerHits from SimTrackerHits, smearing them according to the input parameters.-->
    <parameter name="SubDetectorName" type="string"> OuterTrackers </parameter>
    <!--whether hits are 1D strip hits-->
    <parameter name="IsStrip" type="bool"> false </parameter>
    <!--resolution in direction of u-->
    <parameter name="ResolutionU" type="float"> 0.010 </parameter>
    <!--resolution in direction of v-->
    <parameter name="ResolutionV" type="float"> 0.010 </parameter>
    <!--Name of the Input SimTrackerHit collection-->
    <parameter name="SimTrackHitCollectionName" type="string" lcioInType="SimTrackerHit"> OuterTrackerBarrelCollection </parameter>
    <!--Name of TrackerHit SimTrackHit relation collection-->
    <parameter name="SimTrkHitRelCollection" type="string" lcioOutType="LCRelation"> OuterTrackerBarrelHitsRelations </parameter>
    <!--Name of the TrackerHit output collection-->
    <parameter name="TrackerHitCollectionName" type="string" lcioOutType="TrackerHitPlane"> OTrackerHits </parameter>
    <!--resolution in time-->
    <parameter name="ResolutionT" type="FloatVec"> 0.1  </parameter>
    <!--resolution in direction of u - either one per layer or one for all layers -->
    <parameter name="UseTimeWindow" type="bool"> true </parameter>
    <!--Correct hit times for propagation: radial distance/c-->
    <parameter name="CorrectTimesForPropagation" type="bool" value="true"/>
    <!--Lower bound of the time window [ns]-->
    <parameter name="TimeWindowMin" type="float"> -0.3 </parameter>
    <!--Upper bound of the time window [ns]-->
    <parameter name="TimeWindowMax" type="float"> 0.3 </parameter>
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <parameter name="Verbosity" type="string"> WARNING </parameter>
  </processor>

  <processor name="OuterEndcapPlanarDigiProcessor" type="DDPlanarDigiProcessor">
    <!--PlanarDigiProcessor creates TrackerHits from SimTrackerHits, smearing them according to the input parameters.-->
    <parameter name="SubDetectorName" type="string"> OuterTrackers </parameter>
    <!--whether hits are 1D strip hits-->
    <parameter name="IsStrip" type="bool"> false </parameter>
    <!--resolution in direction of u-->
    <parameter name="ResolutionU" type="float"> 0.010 </parameter>
    <!--resolution in direction of v-->
    <parameter name="ResolutionV" type="float"> 0.010 </parameter>
    <!--Name of the Input SimTrackerHit collection-->
    <parameter name="SimTrackHitCollectionName" type="string" lcioInType="SimTrackerHit"> OuterTrackerEndcapCollection </parameter>
    <!--Name of TrackerHit SimTrackHit relation collection-->
    <parameter name="SimTrkHitRelCollection" type="string" lcioOutType="LCRelation"> OuterTrackerEndcapHitsRelations </parameter>
    <!--Name of the TrackerHit output collection-->
    <parameter name="TrackerHitCollectionName" type="string" lcioOutType="TrackerHitPlane"> OTrackerEndcapHits </parameter>
    <!--resolution in time-->
    <parameter name="ResolutionT" type="FloatVec"> 0.1  </parameter>
    <!--resolution in direction of u - either one per layer or one for all layers -->
    <parameter name="UseTimeWindow" type="bool"> true </parameter>
    <!--Correct hit times for propagation: radial distance/c-->
    <parameter name="CorrectTimesForPropagation" type="bool" value="true"/>
    <!--Lower bound of the time window [ns]-->
    <parameter name="TimeWindowMin" type="float"> -0.3 </parameter>
    <!--Upper bound of the time window [ns]-->
    <parameter name="TimeWindowMax" type="float"> 0.3 </parameter>
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <parameter name="Verbosity" type="string"> WARNING </parameter>
  </processor>


  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->
  <!-- == Track finding configuration                                                                        == -->
  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->

  <!-- == CONFORMAL TRACKING parameters == -->

  <processor name="ConformalTrackingILC" type="ConformalTrackingV2">
    <!--ConformalTracking constructs tracks using a combined conformal mapping and cellular automaton approach.-->
    <!--Name of the TrackerHit input collections-->
    <parameter name="TrackerHitCollectionNames" type="StringVec" lcioInType="TrackerHitPlane"> VXDTrackerHits VXDEndcapTrackerHits ITrackerHits OTrackerHits ITrackerEndcapHits OTrackerEndcapHits </parameter>
    <!--Name of the MCParticle input collection-->
    <parameter name="MCParticleCollectionName" type="string" lcioInType="MCParticle">MCParticle </parameter>
    <!--Name of the TrackerHit relation collections-->
    <parameter name="RelationsNames" type="StringVec" lcioInType="LCRelation"> VXDTrackerHitRelations VXDEndcapTrackerHitRelations InnerTrackerBarrelHitsRelations OuterTrackerBarrelHitsRelations InnerTrackerEndcapHitsRelations OuterTrackerEndcapHitsRelations </parameter>
    <!--Silicon track Collection Name-->
    <parameter name="SiTrackCollectionName" type="string" lcioOutType="Track">SiTracksCT </parameter>
    <!--Debug hits Collection Name-->
    <parameter name="DebugHits" type="string" lcioOutType="TrackerHitPlane"> DebugHits </parameter>
    <!--Maximum number of track hits to try the inverted fit-->
    <parameter name="MaxHitInvertedFit" type="int">4 </parameter>
    <!--Final minimum number of track clusters-->
    <parameter name="MinClustersOnTrackAfterFit" type="int">4 </parameter>
    <!--enable debug timing -->
    <parameter name="DebugTiming" type="bool">true </parameter>
    <!--enable debug plots -->
    <parameter name="DebugPlots" type="bool">true </parameter>
    <!--retry with tightened parameters, when too many tracks are being created-->
    <parameter name="RetryTooManyTracks" type="bool">false </parameter>
    <parameter name="TooManyTracks" type="int">500000 </parameter>
    <!--sort results from kdtree search-->
    <parameter name="SortTreeResults" type="bool">true </parameter>

    <parameter name="Steps" type="StringVec">
      [VXDBarrel]
      @Collections : VXDTrackerHits
      @Parameters : MaxCellAngle : 0.005; MaxCellAngleRZ : 0.005; Chi2Cut : 100; MinClustersOnTrack : 4; MaxDistance : 0.02; SlopeZRange: 10.0; HighPTCut: 10.0;
      @Flags : HighPTFit, VertexToTracker
      @Functions : CombineCollections, BuildNewTracks
      [VXDEncap]
      @Collections : VXDEndcapTrackerHits
      @Parameters : MaxCellAngle : 0.005; MaxCellAngleRZ : 0.005; Chi2Cut : 100; MinClustersOnTrack : 4; MaxDistance : 0.02; SlopeZRange: 10.0; HighPTCut: 0.0;
      @Flags : HighPTFit, VertexToTracker
      @Functions : CombineCollections, ExtendTracks
      [LowerCellAngle1]
      @Collections : VXDTrackerHits, VXDEndcapTrackerHits
      @Parameters : MaxCellAngle : 0.025; MaxCellAngleRZ : 0.025; Chi2Cut : 100; MinClustersOnTrack : 4; MaxDistance : 0.02; SlopeZRange: 10.0; HighPTCut: 10.0;
      @Flags : HighPTFit, VertexToTracker, RadialSearch
      @Functions : CombineCollections, BuildNewTracks
      [LowerCellAngle2]
      @Collections :
      @Parameters : MaxCellAngle : 0.05; MaxCellAngleRZ : 0.05; Chi2Cut : 2000; MinClustersOnTrack : 4; MaxDistance : 0.02; SlopeZRange: 10.0; HighPTCut: 10.0;
      @Flags : HighPTFit, VertexToTracker, RadialSearch
      @Functions : BuildNewTracks, SortTracks
      [Tracker]
      @Collections : ITrackerHits, OTrackerHits, ITrackerEndcapHits, OTrackerEndcapHits
      @Parameters : MaxCellAngle : 0.05; MaxCellAngleRZ : 0.05; Chi2Cut : 2000; MinClustersOnTrack : 4; MaxDistance : 0.02; SlopeZRange: 10.0; HighPTCut: 0.0;
      @Flags : HighPTFit, VertexToTracker, RadialSearch
      @Functions : CombineCollections, ExtendTracks
      [Displaced]
      @Collections : VXDTrackerHits, VXDEndcapTrackerHits, ITrackerHits, OTrackerHits, ITrackerEndcapHits, OTrackerEndcapHits
      @Parameters : MaxCellAngle : 0.05; MaxCellAngleRZ : 0.05; Chi2Cut : 1000; MinClustersOnTrack : 5; MaxDistance : 0.015; SlopeZRange: 10.0; HighPTCut: 10.0;
      @Flags : OnlyZSchi2cut, RadialSearch
      @Functions : CombineCollections, BuildNewTracks
    </parameter>

    <parameter name="trackPurity" type="double">0.7 </parameter>
    <parameter name="ThetaRange" type="double"> 0.05 </parameter>
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <parameter name="Verbosity" type="string">DEBUG7</parameter>
  </processor>

  <!-- == TruthTrackFinder parameters == -->

  <processor name="MyTruthTrackFinder" type="TruthTrackFinder">
    <parameter name="FitForward" type="bool">true</parameter>
    <!--Define input tracker hits and relations. NB. Order must be respected -->
    <parameter name="TrackerHitCollectionNames" type="StringVec" lcioInType="TrackerHitPlane">
      VXDTrackerHits
      ITrackerHits
      OTrackerHits
      VXDEndcapTrackerHits
      ITrackerEndcapHits
      OTrackerEndcapHits
    </parameter>
    <parameter name="SimTrackerHitRelCollectionNames" type="StringVec" lcioInType="LCRelation">
      VXDTrackerHitRelations
      InnerTrackerBarrelHitsRelations
      OuterTrackerBarrelHitsRelations
      VXDEndcapTrackerHitRelations
      InnerTrackerEndcapHitsRelations
      OuterTrackerEndcapHitsRelations
    </parameter>
    <!--Name of the MCParticle input collection-->
    <parameter name="MCParticleCollectionName" type="string" lcioInType="MCParticle">MCParticle </parameter>
    <!--Silicon track Collection Name-->
    <parameter name="SiTrackCollectionName" type="string" lcioOutType="Track">SiTracks </parameter>
    <!--Silicon track particle relation Collection Name-->
    <parameter name="SiTrackRelationCollectionName" type="string" lcioOutType="LCRelation">SiTrackRelations </parameter>
    <!--If true use the truth information to initialise the helical prefit, otherwise use prefit by fitting 3 hits-->
    <parameter name="UseTruthInPrefit" type="bool">false </parameter>
    <parameter name="Verbosity" type="string">SILENT </parameter>
  </processor>

  <processor name="ClonesAndSplitTracksFinder" type="ClonesAndSplitTracksFinder">
    <parameter name="InputTrackCollectionName" type="string"> SiTracksCT </parameter>
    <parameter name="OutputTrackCollectionName" type="string"> SiTracks </parameter>
    <parameter name="MultipleScatteringOn" type="bool"> true </parameter>
    <parameter name="EnergyLossOn" type="bool"> true </parameter>
    <parameter name="SmoothOn" type="bool"> false </parameter>
    <parameter name="extrapolateForward" type="bool"> true </parameter>
    <parameter name="maxDeltaTheta" type="double"> 0.59 </parameter>
    <parameter name="maxDeltaPhi" type="double"> 0.99 </parameter>
    <parameter name="maxDeltaPt" type="double"> 0.69 </parameter>
    <parameter name="mergeSplitTracks" type="bool"> false </parameter>
  </processor>

  <processor name="Refit" type="RefitFinal">
    <!--Refit processor that calls finaliseLCIOTrack after taking the trackstate from the existing track. No re-sorting of hits is done-->
    <!--Use Energy Loss in Fit-->
    <parameter name="EnergyLossOn" type="bool"> true </parameter>
    <!--Name of the input track to MCParticle relation collection-->
    <parameter name="InputRelationCollectionName" type="string" lcioInType="LCRelation"> SiTrackRelations </parameter>
    <!--Name of the input track collection-->
    <parameter name="InputTrackCollectionName" type="string" lcioInType="Track"> SiTracks </parameter>
    <!--maximum allowable chi2 increment when moving from one site to another-->
    <parameter name="Max_Chi2_Incr" type="double"> 1.79769e+30 </parameter>
    <!--Use MultipleScattering in Fit-->
    <parameter name="MultipleScatteringOn" type="bool"> true </parameter>
    <!--Refit Track to MCParticle relation collection Name-->
    <parameter name="OutputRelationCollectionName" type="string" lcioOutType="LCRelation">
      SiTracks_Refitted_Relation
    </parameter>
    <!--Name of the output track collection-->
    <parameter name="OutputTrackCollectionName" type="string" lcioOutType="Track">
      SiTracks_Refitted
    </parameter>
    <!--Identifier of the reference point to use for the fit initialisation, -1 means at 0 0 0-->
    <parameter name="ReferencePoint" type="int"> -1 </parameter>
    <!--Smooth All Mesurement Sites in Fit-->
    <parameter name="SmoothOn" type="bool"> false </parameter>
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <!--parameter name="Verbosity" type="string"> DEBUG </parameter-->
    <!--if true extrapolation in the forward direction (in-out), otherwise backward (out-in)-->
    <parameter name="extrapolateForward" type="bool"> true </parameter>
    <!--Final minimum number of track clusters-->
    <parameter name="MinClustersOnTrackAfterFit" type="int">3 </parameter>
  </processor>

 
  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->
  <!-- == Performance Processors                                                                             == -->
  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->

  <processor name="MyClicEfficiencyCalculator" type="ClicEfficiencyCalculator">
    <!--ClicEfficiencyCalculator calculates the tracking efficiency and makes some performance plots-->
    <!--Name of the efficiency tree-->
    <parameter name="efficiencyTreeName" type="string">trktree </parameter>
    <!--Name of the purity tree-->
    <parameter name="purityTreeName" type="string">puritytree </parameter>
    <!--Name of the efficiency tree-->
    <parameter name="mcTreeName" type="string">mctree </parameter>   <!-- probably to be killed soon -->
    <!--Track collection name-->
    <parameter name="TrackCollectionName" type="string" lcioInType="Track"> SiTracks_Refitted </parameter>
    <!--Name of the TrackerHit input collections-->
    <parameter name="TrackerHitCollectionNames" type="StringVec" lcioInType="TrackerHitPlane"> VXDTrackerHits VXDEndcapTrackerHits ITrackerHits OTrackerHits ITrackerEndcapHits OTrackerEndcapHits  </parameter>
    <!--Name of TrackerHit relation collections-->
    <parameter name="TrackerHitRelCollectionNames" type="StringVec" lcioInType="LCRelation"> VXDTrackerHitRelations VXDEndcapTrackerHitRelations InnerTrackerBarrelHitsRelations OuterTrackerBarrelHitsRelations InnerTrackerEndcapHitsRelations OuterTrackerEndcapHitsRelations </parameter>
    <!--Name of the MCParticle input collection-->
    <parameter name="MCParticleCollectionName" type="string" lcioInType="MCParticle">MCParticle </parameter>
    <!--Name of the MCPhysicsParticles input collection-->
    <parameter name="MCPhysicsParticleCollectionName" type="string" lcioInType="MCParticle">MCPhysicsParticles </parameter>
    <!--Name of the output collection of the not reconstructed charged MCParticle-->
    <parameter name="MCParticleNotReco" type="string" lcioOutType="MCParticle">MCParticleNotReco </parameter>
    <parameter name="EfficientMCParticleCollection" type="string" lcioOutType="MCParticle" > EfficientMCParticles </parameter>
    <parameter name="InefficientMCParticleCollection" type="string" lcioOutType="MCParticle"> InefficientMCParticles </parameter>

    <!--If true additional plots (n of hits per subdetector per mc particle, mc theta, mc pt, info if the particle is decayed in the tracker) will be added to the Ntuple mctree-->
    <parameter name="morePlots" type="bool">true </parameter>
    <!--Set of cuts to define 'reconstractable' particles for eff computation. The options are: NHits, NHitsVXD, ILDLike-->
    <parameter name="reconstructableDefinition" type="string">ILDLike </parameter>
    <!--Detector element ID for the vertex Barrel-->
    <parameter name="vertexBarrelID" type="int">1 </parameter>  <!-- obsolete -->
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <!--parameter name="Verbosity" type="string">DEBUG </parameter-->
  </processor>

  <processor name="MyTrackChecker" type="TrackChecker">
    <!--TrackChecker plots pull distributions, track resolution parameters and reconstruction efficiencies-->
    <!--Name of the MCParticle input collection-->
    <parameter name="MCParticleCollectionName" type="string" lcioInType="MCParticle">MCParticle </parameter>
    <!--Track collection name-->
    <parameter name="TrackCollectionName" type="string" lcioInType="Track"> SiTracks_Refitted </parameter>
    <!--Track relation collection name-->
    <parameter name="TrackRelationCollectionName" type="string" lcioInType="LCRelation">SiTracksMCTruthLink </parameter>
    <!--Name of the root tree-->
    <parameter name="TreeName" type="string">checktree </parameter>
    <!--Flag to fill only tree variables or also histogram version of pulls and residuals-->
    <parameter name="UseOnlyTree" type="bool">true </parameter>  <!-- probably obsolete- to be checked -->
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <!--parameter name="Verbosity" type="string">DEBUG </parameter-->
  </processor>

  <processor name="MyRecoMCTruthLinker" type="RecoMCTruthLinker">
    <!--links RecontructedParticles to the MCParticle based on number of hits used-->
    <!--energy cut for Brems that are kept-->
    <parameter name="BremsstrahlungEnergyCut" type="float">1 </parameter>
    <!--Name of the updated calo-hit MCTruthLink output collection - not created if empty()-->
    <parameter name="CalohitMCTruthLinkName" type="string" lcioOutType="LCRelation"> CalohitMCTruthLink </parameter>
    <!--Name of the Clusters input collection-->
    <parameter name="ClusterCollection" type="string" lcioInType="Cluster">MergedClusters </parameter>
    <!--Name of the clusterMCTruthLink output collection - not created if empty()-->
    <parameter name="ClusterMCTruthLinkName" type="string" lcioOutType="LCRelation"> ClusterMCTruthLink </parameter>
    <!--true: All reco <-> true relations are given, with weight = 10000*calo
              weight+track weight (weights in permill). false: Only highest contributor
              linked,and only to tracks, not clusters if there are any tracks-->
    <parameter name="FullRecoRelation" type="bool">false </parameter>
    <!--Work-around Mokka bug in vertex-is-not-endpoint-of-parent flag (logic inverted)-->
    <parameter name="InvertedNonDestructiveInteractionLogic" type="bool"> false </parameter>
    <!--PDG codes of particles of which the daughters will be kept in the skimmmed MCParticle collection-->
    <!-- FIXME:Check if we really want to keep those -->
    <parameter name="KeepDaughtersPDG" type="IntVec">22 111 310 13 211 321 3120 </parameter>
    <!--Name of the MCParticle input collection-->
    <parameter name="MCParticleCollection" type="string" lcioInType="MCParticle"> MCPhysicsParticles </parameter>
    <!--Name of the skimmed MCParticle  output collection - not created if empty()-->
    <parameter name="MCParticlesSkimmedName" type="string" lcioOutType="MCParticle"> MCParticlesSkimmed </parameter>
    <!--Name of the MCTruthClusterLink output collection-->
    <parameter name="MCTruthClusterLinkName" type="string" lcioOutType="LCRelation"> </parameter>
    <!--Name of the MCTruthRecoLink output collection-->
    <parameter name="MCTruthRecoLinkName" type="string" lcioOutType="LCRelation"> </parameter>
    <!--Name of the trackMCTruthLink output collection-->
    <parameter name="MCTruthTrackLinkName" type="string" lcioOutType="LCRelation"> </parameter>

    <!--Name of the RecoMCTruthLink output collection - not created if empty()-->
    <parameter name="RecoMCTruthLinkName" type="string" lcioOutType="LCRelation"> RecoMCTruthLink </parameter>
    <!--Name of the ReconstructedParticles input collection-->
    <parameter name="RecoParticleCollection" type="string" lcioInType="ReconstructedParticle"> MergedRecoParticles </parameter>
    <!--save photons from Brems-->
    <parameter name="SaveBremsstrahlungPhotons" type="bool">false </parameter>
    <!--Names of the SimCaloHits input collections-->
    <parameter name="SimCaloHitCollections" type="StringVec" lcioInType="SimCalorimeterHit">
      ECalBarrelCollection
      ECalEndcapCollection
      ECalPlugCollection
      HCalBarrelCollection
      HCalEndcapCollection
      HCalRingCollection
      YokeBarrelCollection
      YokeEndcapCollection
    </parameter>
    <!--Name of the  lcrelation collections, that link the SimCalorimeterHit to CalorimeterHit-->
    <parameter name="SimCalorimeterHitRelationNames" type="StringVec" lcioInType="LCRelation">
      RelationCaloHit RelationMuonHit
    </parameter>
    <!--Names of the SimTrackerHits input collection-->
    <parameter name="SimTrackerHitCollections" type="StringVec" lcioInType="SimTrackerHit">
      VertexBarrelCollection
      VertexEndcapCollection
      InnerTrackerBarrelCollection
      OuterTrackerBarrelCollection
      InnerTrackerEndcapCollection
      OuterTrackerEndcapCollection
    </parameter>
    <!--Name of the Tracks input collection-->
    <parameter name="TrackCollection" type="string" lcioInType="Track"> SiTracks_Refitted </parameter>
    <!--Name of the trackMCTruthLink output collection - not created if empty()-->
    <parameter name="TrackMCTruthLinkName" type="string" lcioOutType="LCRelation"> SiTracksMCTruthLink </parameter>
    <!--Name of the lcrelation collections, that link the TrackerHits to their SimTrackerHits.-->
    <parameter name="TrackerHitsRelInputCollections" type="StringVec" lcioInType="LCRelation">
      VXDTrackerHitRelations
      VXDEndcapTrackerHitRelations
      InnerTrackerBarrelHitsRelations
      OuterTrackerBarrelHitsRelations
      InnerTrackerEndcapHitsRelations
      OuterTrackerEndcapHitsRelations
    </parameter>
    <!--true: use relations for TrackerHits, false : use getRawHits -->
    <parameter name="UseTrackerHitRelations" type="bool"> true </parameter>
    <!--If Using Particle Gun Ignore Gen Stat-->
    <parameter name="UsingParticleGun" type="bool"> false </parameter>
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <parameter name="Verbosity" type="string"> MESSAGE </parameter>
    <!--energy cut for daughters that are kept from KeepDaughtersPDG-->
    <parameter name="daughtersECutMeV" type="float"> 10 </parameter>
  </processor>


  <processor name="MyHitResiduals" type="HitResiduals">
    <!--HitResiduals plots te residual between the track fit and the hit in the local coordinate system u,v,w.-->
    <!--Use Energy Loss in Fit-->
    <parameter name="EnergyLossOn" type="bool">true </parameter>
    <!--Maximum increment allowed for the chi2-->
    <parameter name="MaxChi2Increment" type="double">1000 </parameter>
    <!--Use MultipleScattering in Fit-->
    <parameter name="MultipleScatteringOn" type="bool">true </parameter>
    <!--Smooth All Mesurement Sites in Fit-->
    <parameter name="SmoothOn" type="bool">false </parameter>
    <!--Name of the input track collection-->
    <parameter name="TrackCollectionName" type="string" lcioInType="Track"> SiTracks_Refitted </parameter>
    <!--Name of the output root file-->
    <parameter name="outFileName" type="string">residuals.root </parameter>
    <!--Name of the tree-->
    <parameter name="treeName" type="string">restree </parameter>
    <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
    <!--parameter name="Verbosity" type="string">DEBUG </parameter-->
  </processor>


  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->
  <!-- == Vertices reconstruction configuration                                                              == -->
  <!-- ======================================================================================================== -->
  <!-- ======================================================================================================== -->

  <!-- ========== Vertexing for flavour tagging (constrained) and vertex resolutions (unconstrained) ==== -->
  <group name="Vertexing">
    <parameter name="Algorithms" type="stringVec"> PrimaryVertexFinder BuildUpVertex </parameter>
    <parameter name="ReadSubdetectorEnergies" type="int" value="0"/> <!-- true for ILD -->
    <parameter name="UpdateVertexRPDaughters" type="int" value="0"/> <!-- false for non-updative PandoraPFOs -->
    <parameter name="TrackHitOrdering" type="int" value="2"/> <!-- Track hit ordering: 0=ILD-LOI (default), 1=ILD-DBD, 2=CLICdet -->
    <parameter name="PrintEventNumber" type="int" value="1"/> <!-- 0 for not printing event number, n for printing every n events -->
    <!-- specify input collection names -->
    <parameter name="UseMCP" type="int" value="0" /> <!-- MC info not used -->
    <parameter name="MCPCollection" type="string" value="MCParticle" />
    <parameter name="MCPFORelation" type="string" value="RecoMCTruthLink" />
    <parameter name="MagneticField" type="float" value="4.0"/> <!-- CLIC B field -->
    <parameter name="BeamSizeX" type="float" value="40.E-6"/> <!-- CLIC beam sizes from CDR -->
    <parameter name="BeamSizeY" type="float" value="1.0E-6"/>
    <parameter name="BeamSizeZ" type="float" value="44E-3"/>
    <!-- parameters for primary vertex finder -->
    <parameter name="PrimaryVertexFinder.BeamspotSmearing" type="boolean" value="false" />
    <parameter name="PrimaryVertexFinder.TrackMaxD0" type="double" value="20." />
    <parameter name="PrimaryVertexFinder.TrackMaxZ0" type="double" value="20." />
    <parameter name="PrimaryVertexFinder.TrackMaxInnermostHitRadius" type="double" value="61" /><!-- obsolete? -->
    <parameter name="PrimaryVertexFinder.TrackMinVtxFtdHits" type="int" value="1" />
    <parameter name="PrimaryVertexFinder.Chi2Threshold" type="double" value="25." />
    <!-- irrelevant because of TrackMinVtxFtdHits = 1 -->
    <parameter name="PrimaryVertexFinder.TrackMinFtdHits" type="int" value="999999" />
    <parameter name="PrimaryVertexFinder.TrackMinVxdHits" type="double" value="999999" />
    <!-- No tracks with hits only in the main silicon tracker -->
    <parameter name="PrimaryVertexFinder.TrackMinTpcHits" type="int" value="999999" />
    <parameter name="PrimaryVertexFinder.TrackMinTpcHitsMinPt" type="double" value="999999" />

    <!-- parameters for secondary vertex finder -->
    <parameter name="BuildUpVertex.TrackMaxD0" type="double" value="10." />
    <parameter name="BuildUpVertex.TrackMaxZ0" type="double" value="20." />
    <parameter name="BuildUpVertex.TrackMinPt" type="double" value="0.1" />
    <parameter name="BuildUpVertex.TrackMaxD0Err" type="double" value="0.1" />
    <parameter name="BuildUpVertex.TrackMaxZ0Err" type="double" value="0.1" />
    <parameter name="BuildUpVertex.TrackMinTpcHits" type="int" value="1" />
    <parameter name="BuildUpVertex.TrackMinTpcHitsMinPt" type="double" value="999999" /><!--FIXME-->
    <parameter name="BuildUpVertex.TrackMinFtdHits" type="int" value="1" />
    <parameter name="BuildUpVertex.TrackMinVxdHits" type="int" value="1" />
    <parameter name="BuildUpVertex.TrackMinVxdFtdHits" type="int" value="1" />
    <parameter name="BuildUpVertex.PrimaryChi2Threshold" type="double" value="25." />
    <parameter name="BuildUpVertex.SecondaryChi2Threshold" type="double" value="9." />
    <parameter name="BuildUpVertex.MassThreshold" type="double" value="10." />
    <parameter name="BuildUpVertex.MinDistFromIP" type="double" value="0.3" />
    <parameter name="BuildUpVertex.MaxChi2ForDistOrder" type="double" value="1.0" />
    <parameter name="BuildUpVertex.AssocIPTracks" type="int" value="1" />
    <parameter name="BuildUpVertex.AssocIPTracksMinDist" type="double" value="0." />
    <parameter name="BuildUpVertex.AssocIPTracksChi2RatioSecToPri" type="double" value="2.0" />
    <parameter name="BuildUpVertex.UseV0Selection" type="int" value="1" />
    <!-- Disable AVF -->
    <parameter name="BuildUpVertex.UseAVF" type="boolean" value="false" />
    <parameter name="BuildUpVertex.AVFTemperature" type="double" value="5.0" />

    <!-- Primary and Secondary vertex finder ================================================ -->
    <processor name="VertexFinder" type="LcfiplusProcessor">
      <!-- run primary and secondary vertex finders -->
      <parameter name="PFOCollection" type="string" value="PFOsFromJets" />
      <parameter name="PrimaryVertexCollectionName" type="string" value="PrimaryVertices" />
      <parameter name="BuildUpVertexCollectionName" type="string" value="BuildUpVertices" />
      <parameter name="BuildUpVertex.V0VertexCollectionName" type="string" value="BuildUpVertices_V0" />
      <parameter name="PrimaryVertexFinder.BeamspotConstraint" type="bool">1 </parameter>
    </processor>

    <!-- Primary and Secondary vertex finder for resolutions ================================= -->
    <processor name="VertexFinderUnconstrained" type="LcfiplusProcessor">
      <!-- run primary and secondary vertex finders -->
      <parameter name="PFOCollection" type="string" value="TightSelectedPandoraPFOs" />
      <parameter name="PrimaryVertexCollectionName" type="string" value="PrimaryVertices_res" />
      <parameter name="BuildUpVertexCollectionName" type="string" value="BuildUpVertices_res" />
      <parameter name="BuildUpVertex.V0VertexCollectionName" type="string" value="BuildUpVertices_V0_res" />
      <parameter name="PrimaryVertexFinder.BeamspotConstraint" type="bool">0 </parameter>
    </processor>
  </group>


